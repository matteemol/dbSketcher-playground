<html lang="en">
<head>
<meta charset="utf-8">
<title>PlantUML link generator</title>
<script src="https://cjrtnc.leaningtech.com/2.3/loader.js"></script>
</head>
<style>
.container {
	display: flex;
	justify-content: center;
	width: 100%;
	height: 70%;
}

.cell {
	width: 50%;
}

#canvas {
	padding: 0px;
	margin: 2px;
	visibility: hidden;
}

#popup {
	background-color: #EEE;
	padding: 10px;
	position: absolute;
	top: 0px;
	right: 0px;
	visibility: hidden;
}

#uml {
	width: 100%;
	height: 100%;
}
#lean {
	background-color: #F2F2FF;
	padding: 0px;
	margin: 0px;
	position: fixed;
	bottom: 0px;
	right: 0px;
	left: 0px;
	width: 100%;
	height: 80px;
}
#lean p {
	margin: 30px 0 0px 120px;
}

#lean img {
	position: fixed;
	margin: 10px 30px 0 30px;
}

#forkme {
	padding: 0px;
	margin: 0px;
	position: fixed;
	top: 0px;
	right: 0px;
}
</style>

<body>
<div id=forkme>
    <a href="https://github.com/plantuml/plantuml-core">
    <img width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_green_007200.png?resize=149%2C149">
    </a>
</div>
<div id=lean>
    <p><i>Powered by <a href=https://docs.leaningtech.com/cheerpj>CheerpJ</a>, a Leaning Technologies Java tool</i>
    </p>
</div>
<div class=container>
    <div class=cell>
        <textarea spellcheck=false id=uml oninput="done()">
@startuml
Alice -> Bob : Holas!
@enduml
        </textarea>
    </div>
</div>
	<!--container-->
<div>
    <button onclick='permlink()'>PermLink</button><a id=permlink href=. target="_blank"></a>
</div>

<script>
var url = "https://www.plantuml.com/plantuml/uml/?";

function permlink() {
    if (version_displayed==0)
        return;
    text = document.getElementById('uml').value;
    console.log("text="+text);
    cjCall("com.plantuml.api.cheerpj.v1.Info", "encode", text).then((res) => {
        console.log("res="+res);
            url = url + res;
        // alert(url);
        document.getElementById('permlink').innerText="Link to PlantUML page";
        document.getElementById('permlink').href=url;

    });
    
}
</script>

</body>

</html>
